<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<title>
		</title>
		<link href="css/style.css" rel="stylesheet" type="text/css" />
		<link href="css/tuch.css" rel="stylesheet" type="text/css" />
		<link href="css/mingjia.css" rel="stylesheet" type="text/css" />
			<!--标准mui.css-->
		<link rel="stylesheet" href="css/mui.min.css">
		<script src="js/mui.min.js"></script>
		<script type="text/javascript" charset="UTF-8">
		mui.init();
		mui.plusReady(function(){
			var web =plus.webview.currentWebview();
			var teacherId=web.teacherId;
			var txt_name=document.getElementById("txt_name");
			var txt_iphone=document.getElementById("txt_iphone");
			var txt_code=document.getElementById("txt_code");
			var btn_code=document.getElementById("btn_code");
			var info_sunmit=document.getElementById("info_sunmit");
			var getCodePath="http://121.40.227.121:8080/AccumulateWealth/jucaipen/sendMobileCode";
			var checkCodePath="http://121.40.227.121:8080/AccumulateWealth/jucaipen/checkMobileCode";
			
			//获取验证码
			btn_code.addEventListener("tap",function(){
				var txt_iphone_value=txt_iphone.value;
				if(txt_iphone_value.length<=10){
					plus.nativeUI.toast("手机号不正确");
					return ;
				}
				mui.ajax(getCodePath,{
					data:{
						telPhone:txt_iphone_value
					},
					type:'get',
					dataType:"json",
					timeout:10000,
					success: function(data){
						if(data.ret_code!=0){
							plus.nativeUI.toast(data.err_msg);
						}
					},
					error: function(e){
						
					}
				})
			})
			
			//提交个人信息
			info_sunmit.addEventListener("tap",function(){
				var txt_name_value=txt_name.value;
				var txt_iphone_value=txt_iphone.value;
				var txt_code_value=txt_code.value;
				var uId=plus.storage.getItem("userId");
				if(uId<=0){
					mui.openWindow({
						url:"login.html",
						id:"login"
					})
					return ;
				}
				if(txt_name_value.length<=0){
					plus.nativeUI.toast("姓名不能为空");
					return ;
				}
				if(txt_iphone_value.length<=10){
					plus.nativeUI.toast("手机号不符合要求");
					return ;
				}
				if(txt_code_value.length<=0){
					plus.nativeUI.toast("验证码不能为空");
					return ;
				}
				mui.ajax(checkCodePath,{
					data:{
						trueName:txt_name_value,
						userId:uId,
						telPhone:txt_iphone_value,
						actionCode:txt_code_value,
						qsName:"海通",
						teacherId:teacherId
					},
					dataType:"json",
					type:"get",
					timeout:10000,
					success: function(data){
						if(data.ret_code==0){
							plus.nativeUI.toast("提交成功");
						}else{
							plus.nativeUI.toast(data.err_code);
						}
					},
					error: function(e){
						
					}
				})
				
			})
			
			
			
			
			
			
			
		})
		
		</script>
	</head>

	<body>
		<header class="header">
			<div class="head">
				<div class="denglu1 mui-action-back">
					<a><img src="image/into_back.png" style="margin-top:0.2rem;" /></a>
				</div>
				<div class="logo1" style="margin-top:0.2rem;">
					<span>完善个人信息</span>
				</div>
			</div>
		</header>
			<div class="information">
				<p class="info_title">请您认真完善资料，确保内容的真实性和准确性。</p>
				<ul>
					<li>
						<input name="txt_name" type="text" id="txt_name" placeholder="请输入真实姓名" />
					</li>
					<li>
						<input name="txt_iphone" type="tel" value="" id="txt_iphone" placeholder="请输入手机号码" />
					</li>
					<li>
						<input name="txt_code" type="text" id="txt_code" placeholder="请输入验证码" />
						<input id="btn_code" type="button" value="获取验证码" />
					</li>
					<li>
						<input type="button" name="info_sunmit" value="确认提交" id="info_sunmit" />
					</li>
				</ul>
			</div>
	</body>

</html>