<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
		<link href="css/style.css" rel="stylesheet" type="text/css" />
		<title></title>
		<!--标准mui.css-->
		<link rel="stylesheet" href="css/mui.min.css">
		<script src="js/mui.min.js"></script>
		<script type="text/javascript" charset="UTF-8">
			mui.init({
				swipeBack:true //启用右滑关闭功能
			});
			mui.plusReady(function() {
				plus.geolocation.getCurrentPosition(function(p){
					alert("纬度："+p.coords.latitude+"经度："+p.coords.longitude+"海拔（米）:"+p.coords.altitude
					+"地址:"+p.coords.address);
				},function(e){ 
					alert(e.message);
				})
				var version;
				/*plus.runtime.getProperty(plus.runtime.appid,function(info){
					 version=info.code;
					// getVersion(); 
				})   */
				var name=plus.os.name;
				var hei=plus.screen.resolutionHeight;
				var  width=plus.screen.resolutionWidth;
				var hDpi=hei*plus.screen.scale;
				var wDpi=width*plus.screen.scale;
				var getVersionPath="http://121.40.227.121:8080/AccumulateWealth/accumulate/updateVersion";
				var dowLoadPath="http://121.40.227.121:8080/AccumulateWealth/jucaipen/downLoadApk";
				var page = document.getElementById('pager');
				var queryAdice = "http://121.40.227.121:8080/AccumulateWealth/jucaipen/adverQuerry";
				var live = document.getElementById("data-live");
				var board = document.getElementById("data-threeboard");
				var attention = document.getElementById("data-attention");
				var hotIdea = document.getElementById('data-hotidea');
				var intoLogin = document.getElementById("loginState");
				//获取版本号
				function getVersion(){
					mui.ajax(getVersionPath,{
						type:"get",
						dataType:"json",
						timeout:10000,
						success: function(data){
							if(data.ret_code==0){
								var versionCode=data.versionCode;
								var apkUrl=data.apkUrl;
								console.log(version);
								if(versionCode>version){
									 //更新版本
								}else{
									//暂无最新的版本可更新
									mui.confirm("有新版本可更新","更新提示",["确定","取消"],function(e){
										   if(e.index==0){
										   	  downLoadApk(apkUrl);
										   }else{
										     
										   } 
									})
								} 
							}
							
						},
						error: function(e){
							
						}
					})
				}
				
				function downLoadApk(downPath){
					console.log(dowLoadPath+"?fileName="+downPath);
					var task=plus.downloader.createDownload(dowLoadPath+"?fileName="+downPath,{},function(d,state){
						if(state==200){ 
							var filePath=d.url;
							console.log(JSON.stringify(d));
							plus.runtime.install(filePath,{},function(d){
								console.log(JSON.stringify(d));
							},function(e){
								console.log(e.message);
							});
						}else{
							
						}
					});
					task.start();
				}
				
				
				
				var url = "";
				//获取广告
				mui.ajax(queryAdice, {
					data: {
						type: 1
					},
					dataType: 'json',
					type: "get",
					timeout: 10000,
					success: function(data) {
						url = url + "<div class='mui-slider-item mui-slider-item-duplicate'><a href='#'><img src=" + data[data.length - 1].imageUrl + " id=" + data[data.length - 1].id + " /></a></div>";
						for (var i = 0; i < data.length; i++) {
							var imageUrl = data[i].imageUrl;
							url = url + "<div class='mui-slider-item'><a href='#'><img src=" + imageUrl + " id=" + data[i].id + " /></a></div>";
						}
						url = url + "<div class='mui-slider-item mui-slider-item-duplicate'><a href='#'><img src=" + data[0].imageUrl + " id=" + data[0].id + " /></a></div>";
						page.innerHTML = url;
						mui("#pager").on("tap", "img", function() {
								var id = this.getAttribute("id");
								if (id == 1) {
									//股权投资
								} else if (id == 2) {
									//证券教学
									mui.openWindow({
										url: "liveRoom.html",
										id: "liveRoom",
										extras: {
											liveId: 1
										},
										waiting: {
											autoShow: false
										}
									})
								} else if (id == 3) {
									//新三板
									mui.openWindow({
										url: "trhreeBoard.html",
										id: "trhreeBoard",
										waiting: {
											autoShow: false
										}
									})
								}
							})
							//设置广告自动轮询
						var gallery = mui(".mui-slider");
						gallery.slider({
							interval: 2000
						});
					},
					error: function(e) {}
				});
				var liveUrl = '';
				//直播回顾
				mui.ajax(" http://121.40.227.121:8080/AccumulateWealth/accumulate/indexSchool", {
					dataType: 'json',
					type: 'post',
					timeout: 10000,
					success: function(data) {
						for (var i = 0; i < data.length; i++) {
							liveUrl = liveUrl + "<li style='float: left;width: 120px;'id=" + data[i].id + ">" + "<span><a ><img src=" + data[i].url + "  /><h3>" + data[i].title + "</h3></a></span></li>";
						}
						live.innerHTML = liveUrl;
						mui("#data-live").on("tap", "li", function() {
							var liveId = this.getAttribute("id");
							mui.openWindow({
								url: "historyLive.html",
								id: "historyLive",
								extras: {
									liveId: liveId
								},
								waiting: {
									autoShow: false
								}
							})
						})
					},
					error: function(e) {}
				});
				var three_board = '';
				//新三板
				mui.ajax("http://121.40.227.121:8080/AccumulateWealth/accumulate/indexNews", {
					data: {
						type: 2
					},
					dataType: 'json',
					type: 'post',
					timeout: 10000,
					success: function(data) {
						for (var i = 0; i < data.length; i++) {
							three_board = three_board + "<li id=" + data[i].id + "><span><a><img src=" + data[i].imageThumb + " /></a></span> " + " <div><h3><a>" + data[i].title + "</a></h3><p style='height: 40px;overflow: hidden;'>" + data[i].descript + "</p></div> </li>";
						}
						board.innerHTML = three_board;
						mui("#data-threeboard").on("tap", "li", function() {
							var nId = this.getAttribute("id");
							mui.openWindow({
								url: "newsDetail.html",
								id: "newsDetail",
								extras: {
									newsId: nId
								},
								waiting: {
									autoShow: false
								}
							})
						})
					},
					error: function(e) {}
				});
				//特别关注
				var attentionUrl = '';
				mui.ajax("http://121.40.227.121:8080/AccumulateWealth/accumulate/indexNews", {
					data: {
						type: 1
					},
					dataType: 'json',
					type: 'post',
					timeout: 10000,
					success: function(data) {
						for (var i = 0; i < data.length; i++) {
							attentionUrl = attentionUrl + " <li id=" + data[i].id + "><a>" + data[i].title + "</a></li>";
						}
						attention.innerHTML = attentionUrl;
						mui("#data-attention").on("tap", "li", function() {
							var nId = this.getAttribute("id");
							mui.openWindow({
								url: "newsDetail.html",
								id: "newsDetail",
								extras: {
									newsId: nId
								},
								waiting: {
									autoShow: false
								}
							})
						})
					},
					error: function(e) {}
				});
				//热门观点
				var hotUrl = '';
				mui.ajax("http://121.40.227.121:8080/AccumulateWealth/jucaipen/hotIdeaList", {
						data: {
							whichPage: 0,
						},
						dataType: 'json',
						type: 'post',
						timeout: 10000,
						success: function(data) {
							for (var i = 0; i < data.length; i++) {
								var body = data[i].bodys.replace(/<[^>]+>/g, "");
								hotUrl = hotUrl + "<li id=" + data[i].id + "><span><a><img src=" + data[i].logImage + "  /></a></span> " + " <div><h3><a style='margin-left:20px'>" + data[i].title + "</a></h3><lable style='height: 2.4rem;overflow: hidden;float:right;margin-left:20px;font-size: 0.8rem;color: #666;line-height:1.2rem;'>" + body + "</lable></div> </li>";
							}
							hotIdea.innerHTML = hotUrl;
							mui("#data-hotidea").on("tap", "li", function() {
								var nId = this.getAttribute("id");
								mui.openWindow({
									url: "ideaDetail.html",
									id: "ideaDetail",
									extras: {
										ideaId: nId
									},
									waiting: {
										autoShow: false
									}
								})
							})
						},
						error: function(e) {}
					})
					//进入登录页面
				intoLogin.addEventListener("tap", function() {
					var uId = plus.storage.getItem("userId");
					if (uId <= 0) {
						mui.openWindow({
							url: "login.html",
							id: "login",
							waiting: {
								autoShow: false
							}
						})
					} else {
						mui.openWindow({
							url: "vipcenter.html",
							id: "vipcenter",
							waiting: {
								autoShow: false
							}
						})
					}})
			})
		</script>

		<style type="text/css">
			.mui-slider {
				margin-top: 40px;
			}
		</style>

	</head>

	<body scroll="no" style="overflow-y: hidden;">

		<div class="wrapper">
			<!------------头部--------------->

			<header class="header">
				<div class="head">
					<div id="pageTop1_show_login_link" class="denglu"> <a id="loginState"><i><img src="image/unlogin.png" /></i><em></em></a></div>
					<div class="logo">
						<a><img src="image/jucai.png" /></a>
					</div>
				</div>
			</header>
			<!------------首页轮播图---------->
			<div class="mui-slider" >
				<div class="mui-slider-group mui-slider-loop" id="pager" >
					<!--广告-->
				</div>
			</div>
			<!------------导航---------->
			<nav class="nav">
				<div class="page_menu">
					<ul>
						<li><a href="liveList.html"><span><img src="image/live_index.png"></span><h4>直播互动</h4></a></li>
						<li><a href="famousDish.html"><span><img src="image/class_index.png"></span><h4>名家看市</h4></a></li>
						<li><a href="trhreeBoard.html"><span><img src="image/licai_index.png"></span><h4>热门投资</h4></a></li>
						<li><a href="attention.html"><span><img src="image/fince_index.png"></span><h4>特别关注</h4></a></li>
					</ul>
				</div>
			</nav>
			<!------------居中部分---------->
			<div class="middle">
				<div class="middlecenter">
					<!----新三板------->
					<div class="zhishi">
						<div class="licai_top">
							<h3>新三板</h3>
							<a href="trhreeBoard.html">更多</a>
						</div>
						<div class="yaowen_b">
							<ul id="data-threeboard">
							</ul>
						</div>
					</div>
					<!------------直播回顾---------->
					<div class="zhibohuigu">
						<div class="zhibohuigu_top">
							<h3>直播回顾</h3>

						</div>
						<div class="zhibohuigu_mian">
							<ul style="list-style: none;" id="data-live">
							</ul>
						</div>
					</div>
					<!------------财经栏目---------->
					<div class="caijing">
						<div class="licai_top">
							<h3>特别关注</h3>
							<a href="attention.html">更多</a>
						</div>
						<div class="caijing_mian">
							<ul id="data-attention">
							</ul>
						</div>
					</div>
					<!------------热门观点---------->
					<div class="remengd" style="background:none">
						<div class="licai_top" style="margin-bottom:0.4rem;">
							<h3>热门观点</h3>
							<a href="intrvlIdea.html">更多</a>
						</div>
						<div class="yaowen_b">
							<ul id="data-hotidea">
							</ul>
						</div>
					</div>
				</div>
			</div>
			<!------------底部定位层---------->

			<footer class="footer">
				<div class="foot">
					<div class="footcenter">
						<ul style="height: 60px;">
							<li><a><span><img src="image/indexpress.png" style="width: 50px;height: 50px;"/></span></a></li>
							<li><a href="trhreeBoard.html"><span><img src="image/licainorma.png" style="width: 50px;height: 50px;"/></span></a></li>
							<li><a href="liveList.html"><span><img src="image/livenormal.png" style="width: 50px;height: 50px;" /></span></a></li>
							<li><a href="attention.html"><span><img src="image/fincenormal.png" style="width: 50px;height: 50px;"/></span></a></li>
							<li><a href="famousDish.html"><span><img src="image/classnormal.png" style="width: 50px;height: 50px;"/></span></a></li>
						</ul>
					</div>
				</div>
			</footer>
		</div>
	</body>

</html>