/*! layer弹层组件拓展类 */
!function(){layer.use("skin/layer.ext.css",function(){layer.layui_layer_extendlayerextjs=!0});var a=layer.cache||{},b=function(c){return a.skin?" "+a.skin+" "+a.skin+"-"+c:""};layer.prompt=function(c,d){c=c||{},"function"==typeof c&&(d=c);var e,i=2==c.formType?'<textarea class="layui-layer-input">'+(c.value||"")+"</textarea>":function(){return'<input type="'+(1==c.formType?"password":"text")+'" class="layui-layer-input" value="'+(c.value||"")+'">'}();return layer.open($.extend({btn:["&#x786E;&#x5B9A;","&#x53D6;&#x6D88;"],content:i,skin:"layui-layer-prompt"+b("prompt"),success:function(f){e=f.find(".layui-layer-input"),e.focus()},yes:function(f){var g=e.val();""===g?e.focus():g.length>(c.maxlength||500)?layer.tips("&#x6700;&#x591A;&#x8F93;&#x5165;"+(c.maxlength||500)+"&#x4E2A;&#x5B57;&#x6570;",e,{tips:1}):d&&d(g,f,e)}},c))},layer.tab=function(c){c=c||{};var d=c.tab||{};return layer.open($.extend({type:1,skin:"layui-layer-tab"+b("tab"),title:function(){var i=d.length,j=1,e="";if(i>0){for(e='<span class="layui-layer-tabnow">'+d[0].title+"</span>";i>j;j++){e+="<span>"+d[j].title+"</span>"}}return e}(),content:'<ul class="layui-layer-tabmain">'+function(){var i=d.length,j=1,e="";if(i>0){for(e='<li class="layui-layer-tabli xubox_tab_layer">'+(d[0].content||"no content")+"</li>";i>j;j++){e+='<li class="layui-layer-tabli">'+(d[j].content||"no  content")+"</li>"}}return e}()+"</ul>",success:function(i){var j=i.find(".layui-layer-title").children(),e=i.find(".layui-layer-tabmain").children();j.on("mousedown",function(g){g.stopPropagation?g.stopPropagation():g.cancelBubble=!0;var h=$(this),f=h.index();h.addClass("layui-layer-tabnow").siblings().removeClass("layui-layer-tabnow"),e.eq(f).show().siblings().hide()})}},c))},layer.photos=function(j,k,l){function w(o,p,m){var n=new Image;n.onload=function(){n.onload=null,p(n)},n.onerror=function(q){n.onerror=null,m(q)},n.src=o}var c={};if(j=j||{},j.photos){var d=j.photos.constructor===Object,e=d?j.photos:{},f=e.data||[],g=e.start||0;if(c.imgIndex=g+1,d){if(0===f.length){return void layer.msg("&#x6CA1;&#x6709;&#x56FE;&#x7247;")}}else{var h=$(j.photos),i=h.find(j.img||"img");if(0===i.length){return}if(k||h.find(e.img||"img").each(function(m){var n=$(this);f.push({alt:n.attr("alt"),pid:n.attr("layer-pid"),src:n.attr("layer-src")||n.attr("src"),thumb:n.attr("src")}),n.on("click",function(){layer.photos($.extend(j,{photos:{start:m,data:f,tab:j.tab},full:j.full}),!0)})}),!k){return}}c.imgprev=function(m){c.imgIndex--,c.imgIndex<1&&(c.imgIndex=f.length),c.tabimg(m)},c.imgnext=function(m,n){c.imgIndex++,c.imgIndex>f.length&&(c.imgIndex=1,n)||c.tabimg(m)},c.keyup=function(m){if(!c.end){var n=m.keyCode;m.preventDefault(),37===n?c.imgprev(!0):39===n?c.imgnext(!0):27===n&&layer.close(c.index)}},c.tabimg=function(m){f.length<=1||(e.start=c.imgIndex-1,layer.close(c.index),layer.photos(j,!0,m))},c.event=function(){c.bigimg.hover(function(){c.imgsee.show()},function(){c.imgsee.hide()}),c.bigimg.find(".layui-layer-imgprev").on("click",function(m){m.preventDefault(),c.imgprev()}),c.bigimg.find(".layui-layer-imgnext").on("click",function(m){m.preventDefault(),c.imgnext()}),$(document).on("keyup",c.keyup)},c.loadi=layer.load(1,{shade:"shade" in j?!1:0.9,scrollbar:!1}),w(f[g].src,function(m){layer.close(c.loadi),c.index=layer.open($.extend({type:1,area:function(){var o=[m.width,m.height],n=[$(window).width()-100,$(window).height()-100];return !j.full&&o[0]>n[0]&&(o[0]=n[0],o[1]=o[0]*n[1]/o[0]),[o[0]+"px",o[1]+"px"]}(),title:!1,shade:0.9,shadeClose:!0,closeBtn:!1,move:".layui-layer-phimg img",moveType:1,scrollbar:!1,moveOut:!0,shift:5*Math.random()|0,skin:"layui-layer-photos"+b("photos"),content:'<div class="layui-layer-phimg"><img src="'+f[g].src+'" alt="'+(f[g].alt||"")+'" layer-pid="'+f[g].pid+'"><div class="layui-layer-imgsee">'+(f.length>1?'<span class="layui-layer-imguide"><a href="javascript:;" class="layui-layer-iconext layui-layer-imgprev"></a><a href="javascript:;" class="layui-layer-iconext layui-layer-imgnext"></a></span>':"")+'<div class="layui-layer-imgbar" style="display:'+(l?"block":"")+'"><span class="layui-layer-imgtit"><a href="javascript:;">'+(f[g].alt||"")+"</a><em>"+c.imgIndex+"/"+f.length+"</em></span></div></div></div>",success:function(o,n){c.bigimg=o.find(".layui-layer-phimg"),c.imgsee=o.find(".layui-layer-imguide,.layui-layer-imgbar"),c.event(o),j.tab&&j.tab(f[g],o)},end:function(){c.end=!0,$(document).off("keyup",c.keyup)}},j))},function(){layer.close(c.loadi),layer.msg("&#x5F53;&#x524D;&#x56FE;&#x7247;&#x5730;&#x5740;&#x5F02;&#x5E38;<br>&#x662F;&#x5426;&#x7EE7;&#x7EED;&#x67E5;&#x770B;&#x4E0B;&#x4E00;&#x5F20;&#xFF1F;",{time:30000,btn:["下一张","不看了"],yes:function(){f.length>1&&c.imgnext(!0,!0)}})})}}}();